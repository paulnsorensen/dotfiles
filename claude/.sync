#!/bin/bash
# Sync Claude Code config files to ~/.claude/

CLAUDE_DIR="$HOME/.claude"
SOURCE_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Create ~/.claude if it doesn't exist
mkdir -p "$CLAUDE_DIR"

# Config to symlink (note: plugins NOT included - Claude uses that dir for plugin cache)
configs=(
  agents
  commands
  hooks
  mcp
  CLAUDE.md
)

for item in "${configs[@]}"; do
  target="$CLAUDE_DIR/$item"
  source="$SOURCE_DIR/$item"
  
  if [[ -e "$source" ]]; then
    if [[ -L "$target" ]]; then
      rm "$target"
    elif [[ -e "$target" ]]; then
      echo "  Backing up existing $item"
      mv "$target" "$target.bak"
    fi
    
    echo "  Linking $item"
    ln -s "$source" "$target"
  fi
done

echo "Claude config synced"
